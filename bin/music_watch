#!/bin/sh

# A kludgy shell script to turn a shaded terminal into a music notifier
# TODO
# Check that it supports all terminals
# Write the mpc stuff more portably
# Package
ARGV="$@"
urxvt_t()
{
    if [ -n "$INSCREEN" ] ; then
        echo -n "\033k$@\033\\"
    else
        echo -n "\033]0;$@\007"
    fi
}

is_arg()
{
    echo $ARGV | grep -- $1 > /dev/null
}

# FIXME Worst arg handling /ever/
len=1
is_arg "-d" &&
    len=2
is_arg "-dd" &&
    len=3

urxvt_t `mpc | head -n $len`
while mpc idle>/dev/null; do
    urxvt_t `mpc | head -n $len`
done
